---
sidebar_position: 1
---

# Server

## Environment Variables

Configure parameters through environment variables, generally used for Docker and Kubernetes deployment.

| Parameter Name | Default Value | Description |
|:----------|---------------------------------------------------------------------------------------------------------:|:--:|
| OJ_ADMIN_USER_PWD_SALT | ... | Encryption salt |
| OJ_DS_DRIVER_CLASS | `com.mysql.cj.jdbc.Driver`| Database driver, using MYSQL as default. |
| OJ_DS_URL | `jdbc:mysql://127.0.0.1:3306/openjob?...` | Database URL address |
| OJ_DS_USERNAME | root | Database account |
| OJ_DS_PASSWORD | 123456 | Database password |
| OJ_DS_HK_MINI_IDLE | 1 | Connection pool minimum idle number |
| OJ_DS_HK_MAX_POOL_SIZE | 10| Connection pool maximum number |
| OJ_DS_HK_IDLE_TIMEOUT | 60000 | Connection pool idle timeout |
| OJ_DS_HK_POOL_NAME | openjob | Connection pool name |
| OJ_FW_LOCATIONS | `classpath:db/migration/mysql` | The file used for migrating tables and structure, generated by MYSQL as default. |
| OJ_FW_TABLE | `migration_version` | The table name used for recording migration history during the process of migrating tables and structure. |
| OJ_LOG_STORAGE_SELECTOR | mysql | Log storage driver type, using MYSQL database as default. |
| OJ_LOG_STORAGE_H2_USER | root| H2 database log storage, database account. |
| OJ_LOG_STORAGE_H2_PASSWORD | 123456 | H2 database log storage, database password. |
| OJ_LOG_STORAGE_H2_URL | `jdbc:h2:mem:openjob;AUTO_RECONNECT=TRUE...`| H2 database log storage, database URL. |
| OJ_LOG_STORAGE_MYSQL_USER | root| MYSQL database log storage, database account. |
| OJ_LOG_STORAGE_MYSQL_PASSWORD | 123456 | MYSQL database log storage, database password. |
| OJ_LOG_STORAGE_MYSQL_URL | jdbc:mysql://127.0.0.1:3306/openjob?... | MYSQL database log storage, database URL. |
| OJ_SCHEDULER_DELAY_ENABLE | false | Configure the enabled status of delayed tasks, using `false` as default. |
| OJ_REDIS_HOST | `127.0.0.1` | Redis host |
| OJ_REDIS_PASSWORD | - | Redis password, using empty as default. |
| OJ_REDIS_DB  | 0 | Redis db |
| SPRING_JPA_SHOW_SQL  | false | SQL printing status, using `false` as default. |

:::tip
1. The container startup parameters are configured through environment variables.
2. Currently, only MySQL is supported as the database driver, and PostgreSQL/Oracle will be supported in the future.
3. Currently, log storage only supports H2/MYSQL, and elasticsearch/tidb/MongoDB will be supported in the future.
4. Delayed tasks are optional, but if enabled, Redis must be configured, otherwise the service cannot be used.
5. There are also some other parameters that are not configured through environment variables. If there is a scenario that needs to be modified, it can be achieved through file mounting.
:::

## Configure File

Configuring parameters through the `application.properties` file is generally used for directly deploying or mounting configuration files in containers.

```shell
server.port=${SERVER_PORT:8080}
### admin config
# user passwd hash salt
openjob.admin.user.passwd-salt=${OJ_ADMIN_USER_PWD_SALT:...}
### spring config
spring.jackson.serialization.FAIL_ON_EMPTY_BEANS=false
spring.datasource.driver-class-name=${OJ_DS_DRIVER_CLASS:com.mysql.cj.jdbc.Driver}
spring.datasource.url=${OJ_DS_URL:jdbc:mysql://127.0.0.1:3306/openjob?useUnicode=true&characterEncoding=UTF-8&serverTimezone=Asia/Shanghai}
spring.datasource.username=${OJ_DS_USERNAME:root}
spring.datasource.password=${OJ_DS_PASSWORD:123456}
spring.datasource.type=com.zaxxer.hikari.HikariDataSource
spring.datasource.hikari.minimum-idle=${OJ_DS_HK_MINI_IDLE:1}
spring.datasource.hikari.maximum-pool-size=${OJ_DS_HK_MAX_POOL_SIZE:10}
spring.datasource.hikari.idle-timeout=${OJ_DS_HK_IDLE_TIMEOUT:60000}
spring.datasource.hikari.pool-name=${OJ_DS_HK_POOL_NAME:openjob}
# fixed warn for "spring.jpa.open-in-view is enabled by default"
spring.jpa.open-in-view=false
spring.flyway.enabled=true
spring.flyway.clean-disabled=true
spring.flyway.locations=${OJ_FW_LOCATIONS:classpath:db/migration/mysql}
spring.flyway.baseline-on-migrate=true
spring.flyway.table=${OJ_FW_TABLE:migration_version}
spring.flyway.baseline-version=0
spring.flyway.encoding=UTF-8
spring.flyway.validate-on-migrate=false
openjob.log.storage.selector=${OJ_LOG_STORAGE_SELECTOR:mysql}
openjob.log.storage.h2.properties.user=${OJ_LOG_STORAGE_H2_USER:root}
openjob.log.storage.h2.properties.password=${OJ_LOG_STORAGE_H2_PASSWORD:123456}
openjob.log.storage.h2.properties.url=${OJ_LOG_STORAGE_H2_URL:jdbc:h2:mem:openjob;AUTO_RECONNECT=TRUE;MODE=MySQL;DB_CLOSE_DELAY=-1;DATABASE_TO_UPPER=false;WRITE_DELAY=0;}
openjob.log.storage.mysql.properties.user=${OJ_LOG_STORAGE_MYSQL_USER:root}
openjob.log.storage.mysql.properties.password=${OJ_LOG_STORAGE_MYSQL_PASSWORD:123456}
openjob.log.storage.mysql.properties.url=${OJ_LOG_STORAGE_MYSQL_URL:jdbc:mysql://127.0.0.1:3306/openjob?useUnicode=true&characterEncoding=UTF-8&serverTimezone=Asia/Shanghai}
openjob.scheduler.delay.enable=${OJ_SCHEDULER_DELAY_ENABLE:false}
spring.redis.host=${OJ_REDIS_HOST:127.0.0.1}
spring.redis.password=${OJ_REDIS_PASSWORD:}
spring.redis.database=${OJ_REDIS_DB:0}
spring.redis.client-type=lettuce
spring.redis.lettuce.pool.max-active=32
spring.redis.lettuce.pool.max-idle=8
spring.redis.lettuce.pool.max-wait=1000
spring.redis.lettuce.pool.time-between-eviction-runs=60s
spring.jpa.show-sql=${SPRING_JPA_SHOW_SQL:false}
```

:::tip
Configuring parameters is completely consistent with environment variables.
:::